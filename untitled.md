---
description: >-
  Python cookbook:
  https://python3-cookbook.readthedocs.io/zh_CN/latest/c10/p01_make_hierarchical_package_of_modules.html
---

# Libraries

## Directory Structure

```text
$ pwd
/path/to/project/directory/

$ ls
|- notebooks/
   |- 01-first-logical-notebook.ipynb
   |- 02-second-logical-notebook.ipynb
   |- prototype-notebook.ipynb
   |- archive/
	  |- no-longer-useful.ipynb
	 |- figures/ #figures relevant to the project are placed
|- projectname/ #all things that are refactored out of notebooks to keep them clean
   |- projectname/
	  |- __init__.py #import functions and variables into our notebooks and scripts
	  |- config.py #place in special paths and variables that are used across the project
	  |- custom_funcs.py #custome code
	  |- data.py
	  |- utils.py
	  |- test_config.py # respective config.py
	  |- test_custom_funcs.py # respective custom_funs.py
   |- setup.py # name, version. if the project is small, no need for it
|- README.md
|- data/
   |- raw/
   |- processed/
   |- cleaned/
|- scripts/ #getting the data in shape, or stitching together figures generated by individual notebooks.
   |- script1.py
   |- script2.py
   |- archive/
      |- no-longer-useful.py
|- environment.yml
```

In notebook, some packages can be imported:

```python
from projectname import something
from projectname.config import data_path
from projectname.custom_funcs import custom_preprocessor

```



此外还有sklearn的transformerMixin和pipeline等使MLproject变得高效的工具

## Module & Package

Module: .py file

Package: a dictionary with `__init__.py`. 这个文件可以是空的，也可以导入module。

* `__init__.py`中还可以有一个重要的变量，`__all__`。如`__all__=["mod1","mod2"在此module中的两个py文件,"sub"子文件夹]`

{% embed url="https://zhuanlan.zhihu.com/p/37047465" %}

{% embed url="https://www.jianshu.com/p/d0a5a42569cb" %}

[https://zhuanlan.zhihu.com/p/54764686](https://zhuanlan.zhihu.com/p/54764686)

## sys

### sys.path

当我们导入一个模块时：import  xxx，默认情况下python解析器会搜索当前目录、已安装的内置模块和第三方模块，搜索路径存放在**sys模块的path**中：

```python
>>>import sys
>>>sys.path
['/Users/Downloads/code/Python/Project/Haoyuan_Dong_presession_exercise/notebook',
 '/Users/opt/anaconda3/lib/python37.zip',
 '/Users/opt/anaconda3/lib/python3.7']
 >>>sys.path.append("path of package")
```

sys.path returns a list, so we can use `sys.path.append("引用模块的地址")`，来添加自己写的模块

## Environment

配置conda环境：[https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html](https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html)

环境管理：[https://www.jb51.net/softjc/696132.html](https://www.jb51.net/softjc/696132.html)

## pathlib

{% embed url="https://docs.python.org/zh-cn/3/library/pathlib.html" %}

[https://cuiqingcai.com/6598.html](https://cuiqingcai.com/6598.html)

{% embed url="https://zhuanlan.zhihu.com/p/87940289" %}

```text
|- in/
   |- input.xlsx
|- out/
   |- output.xlsx
```

```python
# walk through subdictrinory
in_file = Path.cwd() / "in" / "input.xlsx"
out_file = Path.cwd() / "out" / "output.xlsx"
# another way
in_file = Path.cwd().joinpath("in").joinpath("input.xlsx")
out_file = Path.cwd().joinpath("out").joinpath("output.xlsx")
# tricky way
parts = ["in", "input.xlsx"]
in_file = Path.cwd().joinpath(*parts)

# walk up to parents, the number is bigger, closer to root
In : p = Path('/Users/dongweiming/test')
In : p.parents[0]
Out: PosixPath('/Users/dongweiming')
In : p.parents[1]
Out: PosixPath('/Users')
In : p.parents[2]
Out: PosixPath('/')
In : p.parent
Out: PosixPath('/Users/dongweiming')
In : p.parent.parent
Out: PosixPath('/Users')

# Parse file names
filename = Path("source_data/text_files/raw_data.txt")
print(filename.name)
# prints "raw_data.txt"
print(filename.suffix)
# prints "txt"
print(filename.stem)
# prints "raw_data"
```

